:tocdepth: 3

.. _guppy_redup:

=====
redup
=====

`redup` restores duplicates to deduped placefiles.

::

  usage: redup -d dupfile placefile

Options
=======

-o  Specify the filename to write to.
--out-dir  Specify the directory to write files to.
--prefix  Specify a string to be prepended to filenames.
-d  The dedup file to use to restore duplicates

Details
=======

From placefiles generated by running ``pplacer`` on a deduplicated sequence
file, restore duplicated sequences to the placefiles.

``seqmagick`` can be used to easily deduplicate sequence files and produce
dedup files for use with ``guppy redup``::

    seqmagick convert --deduplicated-sequences-file=sample.dedup sample.fasta sample_deduped.fasta
    pplacer -c sample.refpkg sample_deduped.fasta
    guppy redup -d sample.dedup --prefix reduped_ sample_deduped.json

The format for dedup files is very simple, for ease of reading and writing.
Each dedup file is a series of lines, with a single-space-separated list of
sequences on each line. The first sequence on the line is the sequence that's
put into the deduplicated file, and the rest are synonyms for that same
sequence. For example::

   A_0 A_1 A_2
   B_0
   C_0 C_1

This represents a sequence file containing sequences ``A_0``, ``B_0``, and
``C_0``, which redups to a sequence file where there are additional sequences
``A_1`` and ``A_2`` sequences with the same value as ``A_0``, and an additional
sequence ``C_1`` with the same value as ``C_0``. Sequences with no synonyms
need not be present in the dedup file.

